IMPORT cv2, PIL, pytesseract, os

IMPORT_REQUIRED_LIBRARIES:
    IMPORT cv2, PIL, pytesseract, os

DETECT_PLATE_IN_IMAGE(img):
    img_copy = COPY(img)
    plate_cascade = LOAD_PRETRAINED_CASCADE_CLASSIFIER()

    detected_plates = DETECT_POTENTIAL_PLATE_REGIONS(img_copy, plate_cascade)
    
    FOR EACH plate_region IN detected_plates:
        DRAW_RECTANGLE_AROUND_PLATE_REGION(img_copy, plate_region)
    
    RETURN img_copy, detected_plates

DETECT_PLATE_IN_VIDEO(video_path):
    video_capture = START_VIDEO_CAPTURE(video_path)
    CREATE_DIRECTORY('Number_Plate_detection')

    CREATE_SUBDIRECTORIES('detected_frames', 'number_plates.txt')

    unique_plates = EMPTY_SET()

    WHILE video_capture_IS_OPEN():
        frame = READ_FRAME(video_capture)
        
        IF Frame_SUCCESSFULLY_READ(frame):
            resized_frame = RESIZE_FRAME(frame)
            detected_plates, plate_regions = DETECT_PLATE_IN_IMAGE(resized_frame)
            DISPLAY_FRAME_WITH_DETECTED_PLATES(detected_plates)

            FOR EACH plate_region IN plate_regions:
                plate = EXTRACT_PLATE(frame, plate_region)
                plate_code = GENERATE_UNIQUE_PLATE_CODE(plate_region)
                
                IF PlateCode_NOT_IN_UniqueSet(plate_code, unique_plates):
                    SAVE_DETECTED_PLATE_IMAGE(plate)
                    plate_text = PERFORM_OCR(plate)
                    WRITE_PLATE_TEXT_TO_FILE(plate_text, plate_code)

        CHECK_FOR_EXIT_CONDITIONS()
        HANDLE_ERRORS_AND_EXCEPTIONS()

    RELEASE_VIDEO_CAPTURE()
    CLOSE_ALL_WINDOWS()

    PROCESS_TEXT_FILE('number_plates.txt')

USER_INPUT_FOR_PLATE_DETECTION:
    input_type = GET_USER_INPUT()

    IF input_type == 'image':
        image_path = PROMPT_FOR_IMAGE_PATH()
        img = READ_IMAGE(image_path)
        detected_img, plate_rect = DETECT_PLATE_IN_IMAGE(img)
        DISPLAY_DETECTED_PLATES(detected_img)
        EXTRACT_TEXT_FROM_PLATES_AND_WRITE_TO_FILE(plate_rect)

    ELSE IF input_type == 'video':
        video_path = PROMPT_FOR_VIDEO_PATH()
        DETECT_PLATE_IN_VIDEO(video_path)

    ELSE:
        HANDLE_INVALID_INPUT_MESSAGE()